<div class="container">
	<% @user.milestone_tracks.each do |track| %>
		<div class="row" id="<%= track.id %>">
			<h4><%= track.name %></h4>
			<h5>Milestone Type: <%= track.track_type %></h5>
			<div class="line col-sm-11">
				<hr/>
			</div>
			<div class="line col-sm-1">
				<span class="glyphicon glyphicon-certificate btn-lg"></span>
			</div>
			<div>
				<ul>
					<% @milestones_all.where(track_id: track.id ).each do |m| %>
							<% unless m.completed? %>
								<li class="milestone_icon" id="<%= m.id %>"><span class="glyphicon glyphicon-star-empty btn-lg"></span>
							<% else %>
								<li class="milestone_icon" id="<%= m.id %>"><span class="glyphicon glyphicon-star btn-lg"></span>
							<% end %>
								<milestone class="hidden">
									<div class="card" id="<%= m.id %>">
										<h4><%= m.name %></h4>
										<% unless m.completed? %>
											<%= form_for [track, @milestone] do |f| %>
												<div class="field">
													<%= f.check_box(:completed) %>
													<%= f.label :"Complete this milestone?" %>
													<%= f.hidden_field :name, :value => m.name %>
													<%= f.hidden_field :m_id, :value => m.id %>
												</div>

												<div class="actions">
													<%= f.submit "Complete Milestone" %>
												</div>
											<% end %>
										<% end %>
										<span class="glyphicon glyphicon-pencil edit-button"> </span>
										<div class="hidden">
											<%= form_for [track, @milestone] do |f| %>
												<div class="field">
													<%= f.label :"New name for this Milestone" %><br />
													<%= f.text_field :name, required: true, :value => m.name %>
													<%= f.hidden_field :track_id, :value => track.id %>
													<%= f.hidden_field :m_id, :value => m.id %>
												</div>

												<div class="actions">
													<%= f.submit "Edit Milestone" %>
												</div>

											<% end %>
										</div>
									</div>
								</milestone>
							</li>

					<% end %>
				</ul> <br />
			</div>
		</div>

		<%= form_for [track, @milestone] do |f| %>
			<div class="field">
				<%= f.label :"Name of new Milestone" %><br />
				<%= f.text_field :name, required: true %>
				<%= f.hidden_field :track_id, :value => track.id %>
				<% if track.track_type == "Monetary" %>
					<br /> Ammount to save: $<%= f.number_field :number, required: true %>
				<% end %>
			</div>

			<div class="actions">
				<%= f.submit "Create new milestone" %>
			</div>

		<% end %> <br />
	<% end %>
</div>
<hr />

<%= form_for [@user, @milestone_track] do |f| %>
	<div class="field">
		<%= f.label :"Name of new Milestone track" %><br />
		<%= f.text_field :name, required: true %>
		<%= f.select :track_type, ["Monetary", "Education", "Fitness", "Lifestyle"] %>
	</div>

	<div class="actions">
		<%= f.submit "Create new track" %>
	</div>
<% end %>


<!-- Script for showing and displaying Milestones -->
<script>
	milestones();
</script>
